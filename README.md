# next-auto-import

Auto-import generator for Next.js projects. Automatically scans your directories and generates TypeScript declarations for global auto-imports, inspired by [unplugin-auto-import](https://github.com/unplugin/unplugin-auto-import).

## Features

- üöÄ Automatically scan directories for exports
- üìù Generate TypeScript declaration files
- üîÑ Watch mode in development
- ‚ö° Zero runtime overhead
- üéØ Full TypeScript support

## Installation

```bash
pnpm add next-auto-import
# or
npm install next-auto-import
# or
yarn add next-auto-import
```

## Usage

### Basic Setup

In your `next.config.js` or `next.config.mjs`:

```js
import { withAutoImport } from 'next-auto-import'

const nextConfig = {
  // your next config
}

export default withAutoImport({
  dirs: ['./src/components', './src/utils'],
  dts: './auto-imports.d.ts',
})(nextConfig)
```

### TypeScript Configuration

Make sure to include the generated `.d.ts` file in your `tsconfig.json`:

```json
{
  "compilerOptions": {
    // ... other options
  },
  "include": ["auto-imports.d.ts", "**/*.ts", "**/*.tsx"]
}
```

## Options

```typescript
interface AutoImportOptions {
  /**
   * Directories to scan for auto imports
   * @default ['./src/components', './src/utils']
   */
  dirs?: string[]

  /**
   * Output path for the .d.ts file
   * @default './auto-imports.d.ts'
   */
  dts?: string | boolean

  /**
   * Root directory
   * @default process.cwd()
   */
  root?: string

  /**
   * File extensions to scan
   * @default ['.ts', '.tsx', '.js', '.jsx']
   */
  extensions?: string[]

  /**
   * Patterns to exclude
   * @default ['**/*.test.*', '**/*.spec.*', '**/node_modules/**']
   */
  exclude?: string[]

  /**
   * Whether to preserve file extensions in import paths
   * @default false
   */
  preserveExts?: boolean
}
```

## Example

Given the following file structure:

```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ Button.tsx
‚îÇ   ‚îî‚îÄ‚îÄ Card.tsx
‚îî‚îÄ‚îÄ utils/
    ‚îú‚îÄ‚îÄ format.ts
    ‚îî‚îÄ‚îÄ validate.ts
```

Where `Button.tsx` exports:

```tsx
export function Button() {
  return <button>Click me</button>
}
```

And `format.ts` exports:

```ts
export function formatDate(date: Date) {
  return date.toLocaleDateString()
}
```

The plugin will generate `auto-imports.d.ts`:

```typescript
/* eslint-disable */
/* prettier-ignore */
// @ts-nocheck
// Generated by next-auto-import

declare global {
  const Button: typeof import('./src/components/Button').Button
  const Card: typeof import('./src/components/Card').Card
  const formatDate: typeof import('./src/utils/format').formatDate
  const validate: typeof import('./src/utils/validate').validate
}

export {}
```

Now you can use these exports globally without explicit imports:

```tsx
// Before
import { Button } from '@/components/Button'
import { formatDate } from '@/utils/format'

export default function Page() {
  return <Button>{formatDate(new Date())}</Button>
}

// After (with auto-import)
export default function Page() {
  return <Button>{formatDate(new Date())}</Button>
}
```

## Advanced Usage

### Programmatic API

You can also use the programmatic API:

```typescript
import { createAutoImport } from 'next-auto-import'

const autoImport = createAutoImport({
  dirs: ['./src/components'],
  dts: './types/auto-imports.d.ts',
})

// Generate DTS file
await autoImport.writeDTS()

// Watch for changes (development only)
await autoImport.watch()

// Get scanned imports
const imports = await autoImport.scanDirs()
```

## Notes

- The plugin watches for file changes in development mode and regenerates the `.d.ts` file automatically
- Make sure to add `auto-imports.d.ts` to your `.gitignore` if you prefer to generate it on build
- The generated declarations are global, so be careful with naming conflicts

## Related

- [unplugin-auto-import](https://github.com/unplugin/unplugin-auto-import) - The original auto-import plugin for Vite, Webpack, Rollup, and more

## License

MIT
